- name: Install iTerm2
  homebrew_cask: name=iterm2

- name: Get Tomorrow themes
  git:
    repo: https://github.com/{{ item.repo }}.git
    dest: "{{ item.dest }}"
    depth: 1
  register: tomorrow_git
  with_items:
    - { repo: chriskempson/base16-iterm2, dest: ~/Code/thegcat/base16-iterm2 }
    - { repo: chriskempson/base16-shell, dest: ~/.config/base16-shell }

- name: Install iTerm2 Tomorrow Night theme
  command: open '~/Code/thegcat/base16-iterm2/base16-tomorrownight.dark.itermcolors'
  when: tomorrow_git.results[0].changed

- name: Install tmux
  homebrew: name={{ item }}
  with_items:
    - tmux
    - reattach-to-user-namespace

- name: Install Python
  homebrew: name=python

- name: Install Powerline
  pip: name=powerline-status

- name: Install tpm
  git:
    repo: https://github.com/tmux-plugins/tpm
    dest: ~/.tmux/plugins/tpm
    depth: 1

- name: Make sure needed directories are present
  file:
    path: ~/.config/powerline/themes/tmux
    state: directory

- name: Configure tmux with powerline and fish and tpm
  copy:
    src: "{{ item.src }}"
    dest: "{{ item.dest }}"
  with_items:
    - { src: tmux.conf, dest: ~/.tmux.conf }
    - { src: powerline_themes_tmux_default.json, dest: ~/.config/powerline/themes/tmux/default.json }
